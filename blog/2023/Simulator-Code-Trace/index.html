<!DOCTYPE html> <html lang="cn"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>任务调度场景中的模拟器、源代码与数据集 Trace 汇总 | Linchang Xiao</title> <meta name="author" content="Linchang Xiao"> <meta name="description" content="任务调度场景中的模拟器、源代码与数据集 Trace 汇总"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/icon.jpg?7b7b29ac9f6063e03543e5148578c7f5"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://xlcbingo1999.github.io/blog/2023/Simulator-Code-Trace/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Linchang Xiao</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">任务调度场景中的模拟器、源代码与数据集 Trace 汇总</h1> <p class="post-meta">August 10, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/%E7%B3%BB%E7%BB%9F-ml%E4%BB%BB%E5%8A%A1%E7%BA%A7%E8%B0%83%E5%BA%A6%E8%AE%BA%E6%96%87%E9%9B%86%E5%90%88"> <i class="fa-solid fa-hashtag fa-sm"></i> 系统-ML任务级调度论文集合</a>     ·   <a href="/blog/category/%E5%BC%80%E6%BA%90%E8%B5%84%E6%BA%90%E6%B1%87%E6%80%BB%E6%96%87%E6%A1%A3"> <i class="fa-solid fa-tag fa-sm"></i> 开源资源汇总文档</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="开源代码集合">开源代码集合</h2> <ul> <li>这个知乎账号经常会分享很多源代码：<a href="https://www.zhihu.com/people/jwwthu" rel="external nofollow noopener" target="_blank">https://www.zhihu.com/people/jwwthu</a> </li> </ul> <h2 id="模拟器源代码">模拟器、源代码</h2> <h3 id="cloudsim-系列">CloudSim 系列</h3> <ul> <li> <p>CloudSim 系列及其衍生</p> <ul> <li>CloudSimPy： <a href="https://github.com/FengcunLi/CloudSimPy" rel="external nofollow noopener" target="_blank">https://github.com/FengcunLi/CloudSimPy</a> </li> <li>详细代码解析：<a href="https://we5lw6jk7r.feishu.cn/wiki/wikcnOiCCOD020L9N2VIc0S4CCc" rel="external nofollow noopener" target="_blank">CloudSimPy 模拟器</a> </li> <li>DynamicCloudSim: Simulating heterogeneity in computational clouds[SigComm’19]</li> </ul> </li> <li> <p>基础模块：SimPy</p> </li> </ul> <h3 id="tiresias-开源模拟器">Tiresias 开源模拟器</h3> <ul> <li>Tiresias 开源的模拟器 <ul> <li><a href="https://github.com/SymbioticLab/Tiresias" rel="external nofollow noopener" target="_blank">https://github.com/SymbioticLab/Tiresias</a></li> <li>该模拟器的具体代码解析：<a href="https://we5lw6jk7r.feishu.cn/wiki/wikcnxb4Bz4fZ1i6SwYwtnaS5eI" rel="external nofollow noopener" target="_blank">Tiresias 模拟器</a> </li> </ul> </li> </ul> <h3 id="decima-模拟器">Decima 模拟器</h3> <ul> <li>来源论文：<a href="https://we5lw6jk7r.feishu.cn/wiki/wikcnn5Pzyzx1DfPHDigE7NhKMb" rel="external nofollow noopener" target="_blank">[12.25]SIGCOMM’19@Learning scheduling algorithms for data processing clusters.pdf</a> <ul> <li>github 地址：<a href="https://github.com/hongzimao/decima-sim" rel="external nofollow noopener" target="_blank">https://github.com/hongzimao/decima-sim</a> </li> <li>浙大的一个学生进行复现：</li> </ul> </li> <li>优点</li> <li>缺点 <ul> <li>不能使用 GPU。。。</li> </ul> </li> <li>基础模块</li> </ul> <h3 id="dl-模拟器">DL 模拟器</h3> <ul> <li> <p>来源论文：<a href="https://we5lw6jk7r.feishu.cn/wiki/wikcnisowy8bNvHxPGX1b4ldTYe" rel="external nofollow noopener" target="_blank">[12.10]TPDS’21@DL2_A_Deep_Learning-Driven_Scheduler_for_Deep_Learning_Clusters.pdf</a></p> <ul> <li>Python2.7 + Tensorflow 1.13-gpu</li> <li>包含 multiprocessing</li> <li>包含各种已有的调度算法</li> </ul> </li> <li> <p>详细代码解析：<a href="https://we5lw6jk7r.feishu.cn/wiki/wikcnLqM0S7GYhpBcVObjRhf3Fb" rel="external nofollow noopener" target="_blank">DL2 模拟器</a></p> </li> </ul> <h3 id="商汤科技自研模拟器">商汤科技自研模拟器</h3> <ul> <li>来源论文：<a href="https://we5lw6jk7r.feishu.cn/wiki/wikcnrLNTJSiKVYPYCmXxUZ4kPE" rel="external nofollow noopener" target="_blank">[2.4]A Simulation Platform for Multi-tenant Machine Learning Services on Thousands of GPUs.pdf</a> </li> </ul> <h3 id="qore-dl-源代码">Qore-DL 源代码</h3> <ul> <li>github 地址：<a href="https://github.com/qore-dl/qore-dl-code" rel="external nofollow noopener" target="_blank">https://github.com/qore-dl/qore-dl-code</a> </li> </ul> <h3 id="ekya">ekya</h3> <ul> <li>Github 地址：<a href="https://github.com/edge-video-services/ekya" rel="external nofollow noopener" target="_blank">https://github.com/edge-video-services/ekya</a> </li> <li> <p>概述</p> <ul> <li>边缘段资源分配</li> <li>log 了很多信息，构建准确度和资源之间的函数关系?</li> <li>存在现成的模拟器可以使用</li> </ul> </li> </ul> <h3 id="dss-python-实现的离散调度模拟器">DSS Python 实现的离散调度模拟器</h3> <ul> <li>Github 地址：<a href="https://github.com/epfl-labos/DSS" rel="external nofollow noopener" target="_blank">https://github.com/epfl-labos/DSS</a> </li> </ul> <h3 id="synergy-模拟器-正在阅读">Synergy 模拟器 [正在阅读]</h3> <ul> <li>Github 地址：<a href="https://github.com/msr-fiddle/synergy" rel="external nofollow noopener" target="_blank">https://github.com/msr-fiddle/synergy</a> </li> <li>中文的介绍文档：<a href="https://hliangzhao.cn/articles/000001660896665118db6926f214a2cab4f42f1ebdd563f000" rel="external nofollow noopener" target="_blank">https://hliangzhao.cn/articles/000001660896665118db6926f214a2cab4f42f1ebdd563f000</a>#</li> <li>根据文章的结论，使用文章提供的模拟器得到的结论与真实的 Trace 差距小于 5%，确认了模拟器的保真性。</li> <li>模拟器代码阅读：<a href="https://we5lw6jk7r.feishu.cn/wiki/V9eAw3AiDiitnFkuKtMcn9WJnhc" rel="external nofollow noopener" target="_blank">Synergy 模拟器</a> </li> </ul> <h3 id="dl_cluster_simulator">DL_cluster_simulator</h3> <ul> <li>地址: <a href="https://github.com/nexuslrf/DL_cluster_simulator" rel="external nofollow noopener" target="_blank">https://github.com/nexuslrf/DL_cluster_simulator</a> </li> <li>优点 <ul> <li>有很漂亮的监控界面</li> </ul> </li> <li> <p>缺点</p> <ul> <li>数据文件都不给</li> <li>暂时搁置，等作者回复后检查是否可以把监控界面拿过来用</li> </ul> </li> <li>基础模块</li> </ul> <h3 id="yafs">YAFS</h3> <ul> <li>fog 节点的调度器的</li> <li> <p>优点</p> <ul> <li>有非常多现成的例子，可以直接使用</li> <li>因为是 Fog 节点，因此包含大量的拓扑结构，使用 NetworkX 可以直接快速构建一个图拓扑结构</li> <li>官方文档【目前看来非常齐全】：<a href="https://yafs.readthedocs.io/en/latest/index.html" rel="external nofollow noopener" target="_blank">https://yafs.readthedocs.io/en/latest/index.html</a> </li> <li>发了论文：</li> </ul> </li> <li>基础模块</li> </ul> <h3 id="privacy-budget-scheduling">Privacy Budget Scheduling</h3> <ul> <li>阅读地址：<a href="https://www.usenix.org/conference/osdi21/presentation/luo" rel="external nofollow noopener" target="_blank">Privacy Budget Scheduling</a> </li> <li>模拟器/源码地址：<a href="https://github.com/columbia/PrivateKube" rel="external nofollow noopener" target="_blank">https://github.com/columbia/PrivateKube</a> </li> <li>中文导读：<a href="https://zhuanlan.zhihu.com/p/479524282" rel="external nofollow noopener" target="_blank">https://zhuanlan.zhihu.com/p/479524282</a> </li> <li>优点：</li> <li> <p>基础模块：</p> <ul> <li>desmod（一个用于离散事件处理的模拟器组成模块，docs：<a href="https://desmod.readthedocs.io/en/latest/index.html" rel="external nofollow noopener" target="_blank">https://desmod.readthedocs.io/en/latest/index.html</a>）</li> </ul> </li> <li> <p>流程全整理【确认模拟器的流程】</p> <ul> <li>如何获取数据？</li> <li>数据集从哪里来？</li> <li>如何执行数据层面的 DP 调度？</li> <li>如何执行 GPU 层面的调度？</li> <li>可否整合到 Gavel 中？</li> </ul> </li> </ul> <h3 id="gavel-很好">Gavel [很好]</h3> <ul> <li>模拟器/源码地址：<a href="https://github.com/stanford-futuredata/gavel" rel="external nofollow noopener" target="_blank">https://github.com/stanford-futuredata/gavel</a> </li> <li> <p>优点：</p> <ul> <li>提供了一个调度上的通用最优化问题；</li> <li>使用时间片轮转调度机制，决策变量是 X，然后根据最优化目标的不同，确定一个最优化问题；</li> <li>提供了 Space Sharing 和 Placement Sensitivity 的模拟；</li> <li>提供了性能指标相关数据，为后续研究给予了更多的自信。</li> </ul> </li> <li> <p>缺点：</p> <ul> <li>目前看来主要还是针对轮转作业进行优化；</li> <li>代码中存在一些小 Bug，而且 GPU 种类写死，不太方便进行定制。</li> </ul> </li> <li> <p>流程全整理</p> <ul> <li>Total step 确定？【默认是随机生成的，然后会和 Throughput 的已有数据进行乘操作】</li> <li>算法得到 Allocation 后，还会根据当前实际的任务在 worker 上的处理时间，动态调整得到的结果，最后变成一个_priority 用于队列计算。可能有时候还会遇到_priority 相同的情况，则还会根据_depolit【即衡量目标分配和实际分配的差距，多减少增】去进行划分</li> <li>算法在任务到来和任务结束的时候才会更新 allocation，减少对算法求解器的使用</li> <li>带上 Pref 表示使用数据集中提供的 throughout 【OK】</li> <li>Pack 算法的异同点 <ul> <li>Pack：任务提交【OK】</li> <li>Pack：选中 packing 任务的调度处理方式【OK，没看到什么复杂的，正常处理】</li> <li>Pack：任务单步完成如何结算，任务整体完成如何结算【OK，没看到什么复杂的，正常处理】</li> <li>Pack 算法的计算方式：</li> </ul> </li> <li>接入 philly_job_distribution 后的异同点 <ul> <li>其实就是改变了 scale_factor，使得任务可以获得很大的 scale_factor（即使用多 multi_gpu），在代码中好像就是直接在任务生成的时候就模拟好 philly_job_distribution 的情况，而不是直接从 philly 数据集中获取</li> <li>multi_gpu：任务提交【OK，会在 load throughputs 的时候根据任务的 scale_factor 去获取不同的 throughputs 以用来计算 step】</li> <li>multi_gpu：任务单步完成/整体完成如何结算：多个相同的 GPU 会平均分配单轮的 step 结果，直接考虑使用即可</li> </ul> </li> <li>如何获取 GPU 上的性能数据 <ul> <li>学习并了解 measure_throughput.py 可以获得具体的方法</li> </ul> </li> <li>Water_filling 算法的异同点 <ul> <li>目前没看出来…</li> </ul> </li> <li>SLO 算法的异同点 <ul> <li>其实就是增加了几种云服务厂商给的资源价格，但是没有完整数据，需要自己去收集</li> <li> <a href="https://github.com/search?q=p3.2xlarge&amp;type=Code" rel="external nofollow noopener" target="_blank">https://github.com/search?q=p3.2xlarge&amp;type=Code</a> 进行一波搜索可以找到很多 AWS 的定价数据，这块内容还是比较全面的。直接接入使用即可。最后接入的数据集是：<a href="https://github.com/LucianaMarques/amazon-spot-dataset" rel="external nofollow noopener" target="_blank">https://github.com/LucianaMarques/amazon-spot-dataset</a> </li> <li>应该使用 scripts/drivers/simulate_scheduler_with_generated_jobs.py 去测试</li> </ul> </li> <li>Allox 算法与实现 <ul> <li>使用匈牙利算法进行计算：<a href="https://www.hungarianalgorithm.com/examplehungarianalgorithm.php" rel="external nofollow noopener" target="_blank">https://www.hungarianalgorithm.com/examplehungarianalgorithm.php</a> </li> <li>无法注入多 GPU 任务</li> </ul> </li> <li>FIFO 系列算法的实现方法 <ul> <li>这个算法其实很简单，就是一个队列按顺序调度即可</li> <li>Base: 非抢占式 FIFO；Perf 和 Packed: 抢占式 FIFO, 每个时刻都重新计算 FIFO 的方式</li> </ul> </li> <li>FinishedTimeFairness 系列算法的实现方法（Themis）</li> </ul> </li> <li> <p>如何画图</p> <ul> <li> <code class="language-plaintext highlighter-rouge">scheduler/notebooks/figures/evaluation/continuous_jobs.ipynb</code> contains code to parse the resulting logs and produce graphs (can be run using <code class="language-plaintext highlighter-rouge">jupyter notebook</code>). The notebook should use the appropriate <code class="language-plaintext highlighter-rouge">log_directory</code> used in the above command line.</li> </ul> </li> <li> <p>From_trace：</p> <ul> <li>这个参数一般是可以从 checkpoint 中读取数据，该实验的过程总是非常长，我觉得非常合理。同时，也可以跟随着之前的环境进行进一步的测试。</li> <li>可以从 checkpoint 做恢复进行 debug</li> </ul> </li> <li> <p>如何接入价格和 Elastic</p> <ul> <li>可以接入 aws 的价格数据，aws 的 plot prices 是开源的，可以直接拿来用。</li> <li>每个时刻都会根据价格曲线，从多个数据中心中找最便宜的价格使用即可</li> </ul> </li> <li> <p>如何更换一个新算法</p> <ul> <li>如果想要接入那些不需要考虑公平性和时间轮转的算法，只需要控制队列即可</li> </ul> </li> </ul> <h3 id="pop">POP</h3> <ul> <li>模拟器：<a href="https://github.com/stanford-futuredata/POP" rel="external nofollow noopener" target="_blank">https://github.com/stanford-futuredata/POP</a> <ul> <li>本质上就是在 Gavel 的基础上，加了一个对大矩阵的分切算法，并提供了算法保证。</li> <li>集成更多内容：<a href="https://github.com/stanford-futuredata/pop-ncflow" rel="external nofollow noopener" target="_blank">https://github.com/stanford-futuredata/pop-ncflow</a> </li> </ul> </li> </ul> <h3 id="willump">Willump</h3> <ul> <li>模拟器：<a href="https://github.com/stanford-futuredata/Willump-Simple" rel="external nofollow noopener" target="_blank">https://github.com/stanford-futuredata/Willump-Simple</a> </li> <li>目前看来好像是推断任务的调度加速</li> </ul> <h3 id="parallelsched-停止阅读">ParallelSched [停止阅读]</h3> <ul> <li> <p>浙大的学生实现的一个调度器模拟器</p> <ul> <li>代码：<a href="https://github.com/hliangzhao/ParallelSched" rel="external nofollow noopener" target="_blank">https://github.com/hliangzhao/ParallelSched</a> </li> <li>集成内容：阿里数据集、DL2、Optimus、Tetris、SRTF、DRF、exp_DRF</li> </ul> </li> <li> <p>考虑集成 Optimus、Tetris、DL2 进入 Gavel 中</p> </li> </ul> <h3 id="resalloc-停止阅读">Resalloc [停止阅读]</h3> <ul> <li>POP/ Gavel 作者搞出来的利用优化问题解决调度问题的模拟器：<a href="https://github.com/cvxgrp/resalloc" rel="external nofollow noopener" target="_blank">https://github.com/cvxgrp/resalloc</a> </li> <li>论文：<a href="https://web.stanford.edu/~boyd/papers/resource_alloc.html" rel="external nofollow noopener" target="_blank">https://web.stanford.edu/~boyd/papers/resource_alloc.html</a> </li> <li>和我们想要的场景不太一致…</li> </ul> <h3 id="titansched---chronusartifact">TitanSched &amp; ChronusArtifact</h3> <ul> <li>TitanSched[正在开发中]：<a href="https://github.com/gaow0007/TitanSched" rel="external nofollow noopener" target="_blank">https://github.com/gaow0007/TitanSched</a> </li> <li> <p>ChronusArtifact[代码没法跑..]：<a href="https://github.com/S-Lab-System-Group/ChronusArtifact" rel="external nofollow noopener" target="_blank">https://github.com/S-Lab-System-Group/ChronusArtifact</a></p> <ul> <li>系统架构图：</li> </ul> </li> </ul> <div class="row mt-3"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/2022-06-06-Simulator-Code-Trace/JTW4bDgWJo7WTkxTM0ocoX2ZnVh-480.webp 480w, /assets/img/2022-06-06-Simulator-Code-Trace/JTW4bDgWJo7WTkxTM0ocoX2ZnVh-800.webp 800w, /assets/img/2022-06-06-Simulator-Code-Trace/JTW4bDgWJo7WTkxTM0ocoX2ZnVh-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/2022-06-06-Simulator-Code-Trace/JTW4bDgWJo7WTkxTM0ocoX2ZnVh.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <ul> <li>Astraea[目前看起来比较适合我来做]：<a href="https://github.com/yzs981130/Astraea_Artifacts" rel="external nofollow noopener" target="_blank">https://github.com/yzs981130/Astraea_Artifacts</a> <ul> <li>这篇工作的代码是可以跑出来的，而且看起来没有什么大的 bug</li> <li>具体的方法和后续作者的源码修改：TitanSched</li> </ul> </li> </ul> <h3 id="ones-模拟器">Ones 模拟器</h3> <ul> <li>模拟器代码：<a href="https://github.com/kurisusnowdeng/ones_sc21" rel="external nofollow noopener" target="_blank">https://github.com/kurisusnowdeng/ones_sc21</a> </li> <li>注意：该模拟器是包含任务 epoch 和 acc 的对应关系。</li> </ul> <h3 id="强化学习模拟器-停止阅读">强化学习模拟器 [停止阅读]</h3> <ul> <li>一个专门用于模拟强化学习调度算法的模拟器：<a href="https://github.com/mail-ecnu/VMAgent" rel="external nofollow noopener" target="_blank">https://github.com/mail-ecnu/VMAgent</a> </li> <li> <p>问题</p> <ul> <li>这个模拟器比较老，很多文档写的比较一般</li> <li>连实例代码都很难跑起来，感觉这份代码还是有比较大的问题的！</li> </ul> </li> <li>状态：暂时搁置</li> </ul> <h3 id="deepboot-模拟器-正在阅读">DeepBoot 模拟器 [正在阅读]</h3> <ul> <li>来自文章 [TPDS’23] DeepBoot: Dynamic Scheduling System for Training and Inference Deep Learning Tasks in GPU Cluster</li> <li><a href="https://github.com/czq693497091/DeepBoot" rel="external nofollow noopener" target="_blank">https://github.com/czq693497091/DeepBoot</a></li> <li> <p>优点</p> <ul> <li>这个代码很简单就能跑起来</li> <li>似乎没看到什么大的问题，有点想从里面找一些点来做！</li> <li>适合用来学习以下代码的实现 <ul> <li>Pollux (OSDI’21)</li> <li>AFS (NSDI’21)</li> <li>Tiresias (NSDI’19)</li> <li>Optimus (EuroSys’18)</li> <li>Ayrl (Lyra, EuroSys’23)</li> </ul> </li> </ul> </li> <li>问题</li> </ul> <h3 id="hydra-模拟器-未读">hydra 模拟器 [未读]</h3> <ul> <li>来自文章：<a href="https://we5lw6jk7r.feishu.cn/wiki/OsfrwWf58il1Guk77ODcQu7Xn2b" rel="external nofollow noopener" target="_blank">阅读笔记 - (TC’23) Hydra: Deadline-Aware and Efficiency-Oriented Scheduling for Deep Learning Jobs on Heterogeneous GPUs</a> </li> <li>github：<a href="https://github.com/dos-lab/Hydra" rel="external nofollow noopener" target="_blank">https://github.com/dos-lab/Hydra</a> </li> <li> <p>优点</p> <ul> <li>这份代码写的很不错！纯 GO 语言，适合当 Go 语言的学习</li> <li>似乎没看到什么大的问题，有点想从里面找一些点来做！</li> <li>适合用来学习以下代码的实现 <ul> <li>Allox</li> <li>Gavel</li> <li>Chronus</li> </ul> </li> </ul> </li> <li>问题</li> </ul> <h3 id="beware-of-fragmentation-模拟器-正在阅读">Beware of Fragmentation 模拟器 [正在阅读]</h3> <ul> <li>来自论文：<a href="https://we5lw6jk7r.feishu.cn/wiki/G8GtwdbAui85kDkVfLTckrBhnFj" rel="external nofollow noopener" target="_blank">阅读笔记 - (ATC’23)Beware of Fragmentation: Scheduling GPU-Sharing Workloads with Fragmentation Gradient Descent</a> </li> <li>github：<a href="https://github.com/hkust-adsl/kubernetes-scheduler-simulator" rel="external nofollow noopener" target="_blank">https://github.com/hkust-adsl/kubernetes-scheduler-simulator</a> </li> <li>K8S 调度器、Client-go 和 controller 的源码解读：<a href="https://github.com/jindezgm/k8s-src-analysis/tree/master" rel="external nofollow noopener" target="_blank">https://github.com/jindezgm/k8s-src-analysis/tree/master</a> </li> <li>自定义 K8S 调度插件：<a href="https://www.qikqiak.com/post/custom-kube-scheduler/" rel="external nofollow noopener" target="_blank">https://www.qikqiak.com/post/custom-kube-scheduler/</a> </li> <li>K8S 调度器性能测试代码：<a href="https://github.com/nexuslrf/cl2-scheduler-throughput/tree/master" rel="external nofollow noopener" target="_blank">https://github.com/nexuslrf/cl2-scheduler-throughput/tree/master</a> </li> <li>经典的 K8S 调度流程：<a href="https://we5lw6jk7r.feishu.cn/wiki/JXJfwb362ivNz7kMeF5cKneenad" rel="external nofollow noopener" target="_blank">Beware of Fragmentation 模拟器</a> </li> <li> <p>源码简单阅读：<a href="https://we5lw6jk7r.feishu.cn/wiki/JXJfwb362ivNz7kMeF5cKneenad" rel="external nofollow noopener" target="_blank">Beware of Fragmentation 模拟器</a></p> <ul> <li>整个流程完整地调用了 K8S 中的很多调度接口，对了解和学习 K8S 中的调度接口设计是非常有帮助的！</li> <li>代码里给出的较大规模测试是可以执行的！【但是缩小规模后容易出错，需要仔细看一下】</li> <li>Data =&gt; 比较简单的数据，直接阅读即可理解</li> <li>generate_config_and_run.py <ul> <li>执行逻辑：全部都是使用二进制文件 ./bin/simon 来执行的</li> <li>-gpusel： 这个参数让人疑惑，如果选择了一般的 GPU，执行时间如何获得呢？</li> <li>Gpu sharing 的场景如何进行模拟？</li> </ul> </li> <li>不同的调度算法的区别体现在 yaml 中的，通过更改 <code class="language-plaintext highlighter-rouge">-f</code> 和 <code class="language-plaintext highlighter-rouge">--default-scheduler-config</code> 的配置文件达成</li> <li> <p>核心的调度代码如下 [没有看懂这段代码在.CoreV1().Pods().Get() 执行了何种操作，瞬间就完成了调度逻辑，需要在调试的时候切入一下]</p> <div class="language-go highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="p">(</span><span class="n">sim</span> <span class="o">*</span><span class="n">Simulator</span><span class="p">)</span> <span class="n">createPod</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span><span class="n">corev1</span><span class="o">.</span><span class="n">Pod</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">sim</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">CoreV1</span><span class="p">()</span><span class="o">.</span><span class="n">Pods</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">Namespace</span><span class="p">)</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">metav1</span><span class="o">.</span><span class="n">CreateOptions</span><span class="p">{});</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s">"%s(%s): %s"</span><span class="p">,</span> <span class="n">simontype</span><span class="o">.</span><span class="n">CreatePodError</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">GeneratePodKey</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">err</span><span class="o">.</span><span class="n">Error</span><span class="p">())</span>
    <span class="p">}</span>


    <span class="c">// synchronization</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">syncPodCreate</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="m">2</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Millisecond</span><span class="p">)</span>
    <span class="n">pod</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">sim</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">CoreV1</span><span class="p">()</span><span class="o">.</span><span class="n">Pods</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">Namespace</span><span class="p">)</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">ctx</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">metav1</span><span class="o">.</span><span class="n">GetOptions</span><span class="p">{})</span>
    <span class="k">if</span> <span class="n">pod</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">pod</span><span class="o">.</span><span class="n">Spec</span><span class="o">.</span><span class="n">NodeName</span> <span class="o">!=</span> <span class="s">""</span> <span class="p">{</span>
                    <span class="n">sim</span><span class="o">.</span><span class="n">syncNodeUpdateOnPodCreate</span><span class="p">(</span><span class="n">pod</span><span class="o">.</span><span class="n">Spec</span><span class="o">.</span><span class="n">NodeName</span><span class="p">,</span> <span class="n">pod</span><span class="p">,</span> <span class="m">2</span><span class="o">*</span><span class="n">time</span><span class="o">.</span><span class="n">Millisecond</span><span class="p">)</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">Infof</span><span class="p">(</span><span class="s">"pod(%s) is scheduled to node(%s)</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">GeneratePodKey</span><span class="p">(</span><span class="n">pod</span><span class="p">),</span> <span class="n">pod</span><span class="o">.</span><span class="n">Spec</span><span class="o">.</span><span class="n">NodeName</span><span class="p">)</span>
            <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">log</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s">"[createPod] pod(%s) not created, should not happen"</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">GeneratePodKey</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="no">nil</span>
<span class="p">}</span>
</code></pre></div> </div> </li> </ul> </li> </ul> <h3 id="rotary模拟器testbed-未读">Rotary模拟器+testbed [未读]</h3> <ul> <li> <p>github：<a href="https://github.com/csruiliu/rotary-dlt/tree/main" rel="external nofollow noopener" target="_blank">https://github.com/csruiliu/rotary-dlt/tree/main</a></p> </li> <li> <p>论文导读：<a href="https://we5lw6jk7r.feishu.cn/wiki/XxE4w7hEFi2mQ2kOVVscR4xrn4b" rel="external nofollow noopener" target="_blank">阅读笔记 - (ICDE’23) Rotary: A Resource Arbitration Framework for Progressive Iterative Analytics</a></p> </li> </ul> <h3 id="infadapter-testbed-未读">InfAdapter testbed [未读]</h3> <ul> <li> <p>github：<a href="https://github.com/reconfigurable-ml-pipeline/InfAdapter" rel="external nofollow noopener" target="_blank">https://github.com/reconfigurable-ml-pipeline/InfAdapter</a></p> </li> <li> <p>论文导读：</p> </li> <li> <p>使用K8S集群+TF Serving</p> </li> </ul> <h3 id="jellyfish-testbed-正在阅读">Jellyfish testbed [正在阅读]</h3> <ul> <li>Github： <a href="https://github.com/vuhpdc/jellyfish" rel="external nofollow noopener" target="_blank">https://github.com/vuhpdc/jellyfish</a> </li> <li>论文导读：</li> <li>代码详细分析：</li> </ul> <h3 id="vessim-未读-碳排放模拟器">Vessim [未读] 碳排放模拟器</h3> <ul> <li> <p>Github：<a href="https://github.com/dos-group/vessim" rel="external nofollow noopener" target="_blank">https://github.com/dos-group/vessim</a></p> </li> <li> </li> </ul> <h2 id="trace-整合">Trace 整合</h2> <h3 id="ms-philly-cluster数据集">MS Philly Cluster数据集</h3> <ul> <li>Microsoft提出的一个模拟器 <ul> <li>需要git lfs下载：<a href="https://zhuanlan.zhihu.com/p/146683392" rel="external nofollow noopener" target="_blank">https://zhuanlan.zhihu.com/p/146683392</a> </li> <li>地址：<a href="https://github.com/msr-fiddle/philly-traces" rel="external nofollow noopener" target="_blank">https://github.com/msr-fiddle/philly-traces</a> </li> </ul> </li> <li>数据集中为什么会出现那种一分钟结束的任务？ <ul> <li>在Tiresias文章的附录中，讲到因为用户的配置导致的bug，使得这个任务被快速地结束了。</li> </ul> </li> <li>可能有点作用的分析结果 <ul> <li>来自Tiresias文章的附录</li> </ul> </li> </ul> <h3 id="google数据集">Google数据集</h3> <ul> <li>Google Cluster Traces <ul> <li><a href="https://github.com/google/cluster-data" rel="external nofollow noopener" target="_blank">https://github.com/google/cluster-data</a></li> </ul> </li> </ul> <h3 id="阿里数据集">阿里数据集</h3> <ul> <li><a href="https://github.com/alibaba/clusterdata" rel="external nofollow noopener" target="_blank">https://github.com/alibaba/clusterdata</a></li> <li><em>cluster-trace-v2017</em></li> <li><em>cluster-trace-v2018</em></li> <li><em>cluster-trace-gpu-v2020</em></li> <li><em>cluster-trace-microservices-v2021</em></li> <li><em>cluster-trace-microarchitecture-v2022</em></li> <li> <em>cluster-trace-gpu-v2023</em> <ul> <li>来自论文：<a href="https://we5lw6jk7r.feishu.cn/wiki/G8GtwdbAui85kDkVfLTckrBhnFj" rel="external nofollow noopener" target="_blank">阅读笔记 - (ATC’23)Beware of Fragmentation: Scheduling GPU-Sharing Workloads with Fragmentation Gradient Descent</a> </li> </ul> </li> </ul> <h3 id="商汤数据集">商汤数据集</h3> <ul> <li>HeliosData <ul> <li><a href="https://github.com/S-Lab-System-Group/HeliosData" rel="external nofollow noopener" target="_blank">https://github.com/S-Lab-System-Group/HeliosData</a></li> </ul> </li> </ul> <h3 id="planetlab-workload-traces数据集">planetlab-workload-traces数据集</h3> <ul> <li>planetlab-workload-traces <ul> <li><a href="https://github.com/beloglazov/planetlab-workload-traces" rel="external nofollow noopener" target="_blank">https://github.com/beloglazov/planetlab-workload-traces</a></li> </ul> </li> </ul> <h3 id="pollux论文的一些实验数据">pollux论文的一些实验数据</h3> <ul> <li>Pollux: Co-adaptive Cluster Scheduling for Goodput-Optimized Deep Learning 提供的部分开源数据集 <ul> <li>只有在他们的testbed实验系统上跑的，用于绘图的数据集</li> <li>特点： <ul> <li>数据集很小</li> <li>都是从实际系统上采样得到结果，主要是通过nvidia-smi获得的硬件在每个时刻的使用情况</li> <li>其结果用于绘制下面的几张图</li> </ul> </li> <li>地址：<a href="https://github.com/petuum/pollux-results" rel="external nofollow noopener" target="_blank">https://github.com/petuum/pollux-results</a> </li> </ul> </li> </ul> <h3 id="azure-trace数据集">Azure Trace数据集</h3> <ul> <li> <p><a href="https://github.com/Azure/AzurePublicDataset" rel="external nofollow noopener" target="_blank">https://github.com/Azure/AzurePublicDataset</a></p> </li> <li>特点： <ul> <li>不针对深度学习任务</li> <li>主要是追踪Azure的VM情况</li> </ul> </li> <li>被引用 <ul> <li><a href="https://we5lw6jk7r.feishu.cn/file/boxcnZjVUcgmtWybMjmJKowyntc" rel="external nofollow noopener" target="_blank">[12.20]SOSP’21@Generating Complex, Realistic Cloud Workloads using Recurrent Neural Networks.pdf</a></li> </ul> </li> </ul> <h2 id="任务workload性能建模">任务Workload性能建模</h2> <ul> <li>一篇性能建模的blog（未更新完全）：<a href="https://zhuanlan.zhihu.com/p/548465440" rel="external nofollow noopener" target="_blank">https://zhuanlan.zhihu.com/p/548465440</a> </li> </ul> <h3 id="mlpref">MLPref</h3> <ul> <li>介绍文献：<a href="https://juejin.cn/post/7115232074323197960" rel="external nofollow noopener" target="_blank">https://juejin.cn/post/7115232074323197960</a> </li> </ul> <h3 id="torchprofiler">torch.profiler</h3> <ul> <li> <p>Pytorch原生提供的一个profiler工具：<a href="https://pytorch.org/tutorials/recipes/recipes/profiler_recipe.html" rel="external nofollow noopener" target="_blank">https://pytorch.org/tutorials/recipes/recipes/profiler_recipe.html</a></p> </li> <li> <p>一篇介绍的blog：<a href="https://zhuanlan.zhihu.com/p/403957917" rel="external nofollow noopener" target="_blank">https://zhuanlan.zhihu.com/p/403957917</a></p> </li> </ul> <h3 id="rotary">Rotary</h3> <ul> <li>源码提供了一个profiler工具的新写法：<a href="https://github.com/csruiliu/rotary-dlt/tree/main" rel="external nofollow noopener" target="_blank">https://github.com/csruiliu/rotary-dlt/tree/main</a> </li> </ul> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Linchang Xiao. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>